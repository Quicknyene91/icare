<div
  class="sample-acceptance-and-results"
  *ngIf="{
    samplesToAccept: samplesToAccept$ | async,
    providerDetails: providerDetails$ | async,
    settingLabSampleStatus: settingLabSampleStatus$ | async,
    allSamples: allSamples$ | async,
    worklist: worklist$ | async,
    labDepartments: labDepartments$ | async,
    samplesToFeedResults: samplesToFeedResults$ | async,
    completedSamples: completedSamples$ | async,
    patientsWithCompletedSamples: patientsWithCompletedSamples$ | async,
    rejectedSamples: rejectedSamples$ | async
  } as sampleParams"
>
  <mat-tab-group (selectedTabChange)="onOpenNewTab($event)">
    <mat-tab label="Sample Acceptance">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <!-- {{ sampleParams?.samplesToAccept | json }} -->
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2">Department/Section</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Sample / Specimen
              </th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <!-- <th>Container</th> -->
              <th>
                {{ !LISConfigurations?.isLIS ? "Collected By" : "ID" }}
              </th>
              <!-- <th>Date Ordered</th>
              <th>Source</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.samplesToAccept?.length > 0">
              <ng-container
                *ngFor="
                  let sample of sampleParams?.samplesToAccept;
                  let count = index
                "
              >
                <tr
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <!-- <td></td> -->
                  <td>
                    {{
                      !LISConfigurations?.isLIS
                        ? order?.order?.orderer?.name
                        : order?.order?.orderNumber
                    }}
                  </td>
                  <!-- <td>{{ order?.order?.orderDate | date: "medium" }}</td>
                  <td>{{ order?.order?.location?.name }}</td> -->
                  <!-- <td>{{order?.p_sub_category}} - {{order?.p_sub_category}}</td> -->
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <div class="d-flex justify-content-center w-100">
                      <button
                        [disabled]="
                          sample.accepted ||
                          sample.rejected ||
                          sampleParams?.settingLabSampleStatus
                        "
                        mat-stroked-button
                        class="accept-button"
                        (click)="
                          accept($event, sample, sampleParams?.providerDetails)
                        "
                      >
                        <mat-spinner
                          *ngIf="
                            sampleParams?.settingLabSampleStatus &&
                            savingMessage[sample.id + '-accept']
                          "
                          [diameter]="16"
                        >
                        </mat-spinner>
                        Accept
                      </button>
                      <button
                        [disabled]="
                          sample.accepted ||
                          sample.rejected ||
                          sampleParams?.settingLabSampleStatus
                        "
                        mat-stroked-button
                        class="update-button ml-2"
                        (click)="onUpdateSample(sample)"
                        >
                        Update
                      </button>

                      <button
                        [disabled]="sample.accepted || sample.rejected"
                        mat-stroked-button
                        (click)="
                          reject($event, sample, sampleParams?.providerDetails)
                        "
                        class="ml-2 reject-button"
                      >
                        <mat-spinner
                          *ngIf="
                            sampleParams?.settingLabSampleStatus &&
                            savingMessage[sample.id + '-reject']
                          "
                          [diameter]="16"
                          style="
                            display: inline-block !important;
                            margin-right: 4px;
                          "
                        >
                        </mat-spinner>
                        Reject
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.samplesToAccept?.length == 0">
              <tr>
                <td colspan="14" class="text-danger text-center">
                  No samples waiting acceptance
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Worklist">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept?.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2">Department</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Sample / Specimen
              </th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Status</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <th>
                {{ !LISConfigurations?.isLIS ? "Collected By" : "ID" }}
              </th>
              <!-- <th>Date Ordered</th>
              <th>Source</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.worklist?.length > 0">
              <ng-container
                *ngFor="let sample of sampleParams?.worklist; let count = index"
              >
                <tr
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <td>
                    {{
                      !LISConfigurations?.isLIS
                        ? order?.order?.orderer?.name
                        : order?.order?.orderNumber
                    }}
                  </td>
                  <!-- <td>{{ order?.order?.orderDate | date: "medium" }}</td>
                  <td>{{ order?.order?.location?.name }}</td> -->
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <span *ngIf="sample?.accepted"> Accepted </span>
                    <span *ngIf="sample?.rejected"> Rejected </span>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.worklist?.length == 0">
              <tr>
                <td colspan="14" class="text-danger text-center">
                  No samples you accepted
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab
      label="Results Entry {{ !LISConfigurations?.isLIS ? '& Approval' : '' }}"
    >
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <table style="border: none; margin-left: 15px" class="w-20 float-right">
          <tr style="height: 30px">
            <td style="width: 40px; border: solid 1px #eee"></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                No results filled
              </div>
            </td>
            <td
              style="
                background-color: #ec864acf;
                width: 40px;
                margin-left: 20px;
              "
            ></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                Has results
              </div>
            </td>
            <td
              style="width: 40px; margin-left: 20x"
              [ngStyle]="{
                'background-color': !LISConfigurations?.isLIS
                  ? '#f5f171f7'
                  : '#0080009e'
              }"
            ></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                {{
                  !LISConfigurations?.isLIS
                    ? "Waiting second approval"
                    : "Authorized"
                }}
              </div>
            </td>
            <td
              style="
                background-color: #d04747ab;
                width: 40px;
                margin-left: 20px;
              "
            ></td>
            <td>
              <div style="margin-left: 3px">Has rejected results</div>
            </td>
          </tr>
        </table>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">Department</th>
              <th rowspan="2">Sample / Specimen</th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <!-- <th>Container</th> -->
              <th>
                {{ !LISConfigurations?.isLIS ? "Collected By" : "ID" }}
              </th>
              <!-- <th>Source</th>
              <th>Date Ordered</th> -->
              <!-- <th>Payment</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container
              *ngIf="sampleParams?.samplesToFeedResults?.length > 0"
            >
              <ng-container
                *ngFor="
                  let sample of sampleParams?.samplesToFeedResults;
                  let count = index
                "
              >
                <tr
                  [ngStyle]="{
                    'background-color':
                      sample?.atLestOneOrderWithRejectedResults
                        ? '#d04747ab'
                        : order?.testAllocations[0]?.firstSignOff &&
                          !LISConfigurations?.isLIS
                        ? '#f5f171f7'
                        : order?.testAllocations[0]?.firstSignOff &&
                          LISConfigurations?.isLIS
                        ? '#0080009e'
                        : sample?.atLeastOneHasResults
                        ? '#ec864acf'
                        : ''
                  }"
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <!-- <td></td> -->
                  <td>
                    {{
                      !LISConfigurations?.isLIS
                        ? order?.order?.orderer?.name
                        : order?.order?.orderNumber
                    }}
                  </td>

                  <!-- <td>{{ order?.order?.location?.name }}</td>
                  <td>{{ order?.order?.orderDate | date: "medium" }}</td> -->
                  <!-- <td> {{order?.orderDate | date: 'medium'}}</td> -->
                  <!-- <td>{{order?.p_sub_category}} - {{order?.p_sub_category}}</td> -->
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <button
                      class="colored-button"
                      mat-button
                      (click)="
                        onResultsEntryAndReview(
                          $event,
                          sample,
                          sampleParams?.providerDetails,
                          'Entry'
                        )
                      "
                    >
                      Results entry
                    </button>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container
              *ngIf="sampleParams?.samplesToFeedResults?.length == 0"
            >
              <tr>
                <td colspan="14" class="text-danger text-center">
                  No samples ready for results entry
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Sample Tracking">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <table style="border: none; margin-left: 15px" class="w-20 float-right">
          <tr style="height: 30px">
            <td style="width: 40px; border: solid 1px #eee"></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                No results filled
              </div>
            </td>
            <td
              style="
                background-color: #ec864acf;
                width: 40px;
                margin-left: 20px;
              "
            ></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                Has results
              </div>
            </td>
            <td
              style="width: 40px; margin-left: 20x"
              [ngStyle]="{
                'background-color': !LISConfigurations?.isLIS
                  ? '#f5f171f7'
                  : '#0080009e'
              }"
            ></td>
            <td>
              <div style="margin-left: 3px; margin-right: 20px">
                {{
                  !LISConfigurations?.isLIS
                    ? "Waiting second approval"
                    : "Authorized"
                }}
              </div>
            </td>
            <td
              style="
                background-color: #d04747ab;
                width: 40px;
                margin-left: 20px;
              "
            ></td>
            <td>
              <div style="margin-left: 3px">Has rejected results</div>
            </td>
            <td
              *ngIf="!LISConfigurations?.isLIS"
              style="
                background-color: #6fd67bcf;
                width: 40px;
                margin-left: 20px;
              "
            ></td>
            <td *ngIf="!LISConfigurations?.isLIS">
              <div style="margin-left: 3px">Completed</div>
            </td>
          </tr>
        </table>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2">Department</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Sample / Specimen
              </th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <th>Ordered By</th>
              <!-- <th>Source</th>
              <th>Date Ordered</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.allSamples?.length > 0">
              <ng-container
                *ngFor="
                  let sample of sampleParams?.allSamples;
                  let count = index
                "
              >
                <tr
                  [ngStyle]="{
                    'background-color': sample?.completed
                      ? '#6fd67bcf'
                      : sample?.atLestOneOrderWithRejectedResults &&
                        !sample?.completed
                      ? '#d04747ab'
                      : order?.testAllocations[0]?.firstSignOff &&
                        !LISConfigurations?.isLIS
                      ? '#f5f171f7'
                      : order?.testAllocations[0]?.firstSignOff &&
                        LISConfigurations?.isLIS
                      ? '#0080009e'
                      : sample?.atLeastOneHasResults && !sample?.completed
                      ? '#ec864acf'
                      : ''
                  }"
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <td>{{ order?.order?.orderer?.name }}</td>
                  <!-- <td>{{ order?.order?.location?.name }}</td>
                  <td>{{ order?.order?.orderDate | date: "medium" }}</td> -->
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <button
                      class="colored-button"
                      mat-button
                      (click)="
                        onResultsReview(
                          $event,
                          sample,
                          sampleParams?.providerDetails
                        )
                      "
                    >
                      View results
                    </button>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.allSamples?.length == 0">
              <tr>
                <td colspan="14" class="text-danger text-center">No samples</td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Completed Samples" *ngIf="!LISConfigurations?.isLIS">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2">Department</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Sample / Specimen
              </th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>

              <th rowspan="2">
                {{ !LISConfigurations?.isLIS ? "Collected By" : "Received By" }}
              </th>
              <th rowspan="2">
                {{ !LISConfigurations?.isLIS ? "Collected On" : "Received On" }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <!-- <th>Container</th> -->
              <th>Ordered By</th>
              <!-- <th>Source</th>
              <th>Date Ordered</th> -->
              <!-- <th>Payment</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.completedSamples?.length > 0">
              <ng-container
                *ngFor="
                  let sample of sampleParams?.completedSamples;
                  let count = index
                "
              >
                <tr
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>

                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <!-- <td></td> -->
                  <td>{{ order?.order?.orderer?.name }}</td>

                  <!-- <td>{{ order?.order?.location?.name }}</td>
                  <td>{{ order?.order?.orderDate | date: "medium" }}</td> -->
                  <!-- <td>{{order?.p_sub_category}} - {{order?.p_sub_category}}</td> -->
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.priorityHigh ? "Urgent" : "Routine" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <button
                      class="colored-button"
                      mat-button
                      (click)="
                        onResultsReview(
                          $event,
                          sample,
                          sampleParams?.providerDetails
                        )
                      "
                    >
                      View results
                    </button>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.completedSamples?.length == 0">
              <tr>
                <td colspan="14" class="text-danger text-center">
                  No completed sample
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Results Review" *ngIf="LISConfigurations?.isLIS">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2">Department</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Sample / Specimen
              </th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <!-- <th>Container</th> -->
              <th>
                {{ !LISConfigurations?.isLIS ? "Collected By" : "ID" }}
              </th>
              <!-- <th>Source</th>
              <th>Date Ordered</th> -->
              <!-- <th>Payment</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.completedSamples?.length > 0">
              <ng-container
                *ngFor="
                  let sample of sampleParams?.completedSamples;
                  let count = index
                "
              >
                <tr
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>

                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <!-- <td></td> -->
                  <td>
                    {{
                      !LISConfigurations?.isLIS
                        ? order?.order?.orderer?.name
                        : order?.order?.orderNumber
                    }}
                  </td>

                  <!-- <td>{{ order?.order?.location?.name }}</td>
                  <td>{{ order?.order?.orderDate | date: "medium" }}</td> -->
                  <!-- <td>{{order?.p_sub_category}} - {{order?.p_sub_category}}</td> -->

                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <button
                      class="colored-button"
                      mat-button
                      (click)="
                        onResultsEntryAndReview(
                          $event,
                          sample,
                          sampleParams?.providerDetails,
                          'Review'
                        )
                      "
                    >
                      View results
                    </button>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.completedSamples?.length == 0">
              <tr>
                <td colspan="14" class="text-danger text-center">
                  No Sample With Results
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>

    <mat-tab label="Rejected Samples">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-30 ml-2 float-right">
          <mat-label
            >Select
            {{
              !LISConfigurations?.isLIS ? "Department" : "Section"
            }}</mat-label
          >
          <mat-select [(value)]="selectedDepartment">
            <mat-option (click)="setDepartment('')">All</mat-option>
            <mat-option
              *ngFor="let dept of sampleParams?.labDepartments"
              [value]="dept.display"
              (click)="setDepartment(dept.display)"
            >
              {{ dept.display }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead class="table-header">
            <tr>
              <th rowspan="2">SN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">Department</th>
              <th rowspan="2">Sample / Specimen</th>
              <th rowspan="2">Sample ID</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">MRN</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">
                Patient Names
              </th>
              <th colspan="2" class="text-center">Test details</th>

              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received By</th>
              <th rowspan="2" *ngIf="LISConfigurations?.isLIS">Received On</th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected By" : "Registered By"
                }}
              </th>
              <th rowspan="2">
                {{
                  !LISConfigurations?.isLIS ? "Collected On" : "Registered On"
                }}
              </th>
              <th rowspan="2">Priority</th>
              <th rowspan="2">Reason For Rejection</th>
              <th rowspan="2" *ngIf="!LISConfigurations?.isLIS">Action</th>
            </tr>
            <tr>
              <th>Test Order</th>
              <!-- <th>Container</th> -->
              <th>
                {{ !LISConfigurations?.isLIS ? "Collected By" : "ID" }}
              </th>
              <!-- <th>Source</th>
              <th>Date Ordered</th> -->
              <!-- <th>Payment</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="sampleParams?.rejectedSamples?.length > 0">
              <ng-container
                *ngFor="
                  let sample of sampleParams?.rejectedSamples;
                  let count = index
                "
              >
                <tr
                  *ngFor="let order of sample?.orders; let orderCount = index"
                  [ngClass]="{ 'row-alternated': count % 2 !== 0 }"
                >
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.department?.departmentName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.specimen?.specimenName }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.label }}
                  </td>

                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.mrn }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.patient?.givenName }}
                    {{ sample?.patient?.middleName }}
                    {{ sample?.patient?.familyName }}
                  </td>
                  <td>{{ order?.order?.concept?.display }}</td>
                  <!-- <td></td> -->
                  <td>
                    {{
                      !LISConfigurations?.isLIS
                        ? order?.order?.orderer?.name
                        : order?.order?.orderNumber
                    }}
                  </td>

                  <!-- <td>{{ order?.order?.location?.name }}</td>
                  <td>{{ order?.order?.orderDate | date: "medium" }}</td> -->
                  <!-- <td>{{order?.p_sub_category}} - {{order?.p_sub_category}}</td> -->
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.receivedByStatus?.user?.name }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      sample?.receivedOnStatus?.timestamp
                        ? (sample?.receivedOnStatus?.timestamp | date: "medium")
                        : ""
                    }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.collectedBy?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{ sample?.created | date: "medium" }}
                  </td>
                  <td
                    *ngIf="orderCount == 0"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    {{
                      !LISConfigurations?.isLIS
                        ? sample?.priorityHigh
                          ? "Urgent"
                          : "Routine"
                        : sample?.priorityStatus?.status
                        ? sample?.priorityStatus?.status
                        : "Routine"
                    }}
                  </td>
                  <td>
                    {{ sample?.reasonForRejection?.display }}
                  </td>
                  <td
                    *ngIf="orderCount == 0 && !LISConfigurations?.isLIS"
                    [attr.rowspan]="sample?.orders?.length"
                  >
                    <button
                      *ngIf="!sample?.markedForRecollection"
                      class="colored-button"
                      mat-button
                      (click)="
                        onMarkRecollection(
                          $event,
                          sample,
                          sampleParams?.providerDetails
                        )
                      "
                    >
                      <mat-spinner
                        *ngIf="
                          sampleParams?.settingLabSampleStatus &&
                          savingMessage[sample.id + '-re-collect']
                        "
                        [diameter]="16"
                        style="
                          display: inline-block !important;
                          margin-right: 4px;
                        "
                      >
                      </mat-spinner>
                      Mark for Re-collection
                    </button>
                    <span *ngIf="sample?.markedForRecollection">
                      Waiting for Re-collection
                    </span>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="sampleParams?.rejectedSamples?.length == 0">
              <tr>
                <td colspan="15" class="text-danger text-center">
                  No rejected sample
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Results">
      <div class="filter-and-legend">
        <mat-form-field class="w-50">
          <mat-label>Search</mat-label>
          <mat-icon matPrefix>search</mat-icon
          ><input
            matInput
            (keyup)="onSearch($event)"
            [(ngModel)]="searchingText"
          />
        </mat-form-field>
      </div>
      <div class="p-1">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th style="width: 10px !important">SN</th>
              <th>
                {{ !LISConfigurations?.isLIS ? "Pantient ID" : "Reference ID" }}
              </th>
              <th>
                {{
                  !LISConfigurations?.isLIS
                    ? "Patient names"
                    : "Reference Names"
                }}
              </th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let patient of sampleParams?.patientsWithCompletedSamples;
                let count = index
              "
            >
              <td>
                {{ count + 1 }}
              </td>
              <td>
                {{ patient?.mrn }}
              </td>
              <td>
                {{ patient?.patient?.givenName }}
                {{ patient?.patient?.middleName }}
                {{ patient?.patient?.familyName }}
              </td>
              <td>
                <button
                  class="colored-button"
                  mat-stroked-button
                  (click)="
                    onResultsToPrint(
                      $event,
                      patient,
                      sampleParams?.providerDetails
                    )
                  "
                >
                  Print results
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
